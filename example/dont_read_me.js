!function(i){var n={};function s(t){if(n[t])return n[t].exports;var e=n[t]={i:t,l:!1,exports:{}};return i[t].call(e.exports,e,e.exports,s),e.l=!0,e.exports}s.m=i,s.c=n,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(i,n,function(t){return e[t]}.bind(null,n));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=0)}([function(t,e,i){"use strict";i.r(e);var o=(n.prototype.drawDead=function(){this.draw("#ffcccc")},n.prototype.draw=function(t){for(var e=this.pixelWidth/this.resolutionX,i=this.pixelHeight/this.resolutionY,n=1;n<this.resolutionY-1;n++)for(var s=1;s<this.resolutionX-1;s++)t?this.drawCell(s*e,n*i,e,i,t):this.drawCell(s*e,n*i,e,i)},n.prototype.drawApple=function(t){var e=this.pixelWidth/this.resolutionX,i=this.pixelHeight/this.resolutionY;this.ctx.drawImage(this.appleImg,t.x*e,t.y*i,e,i)},n.prototype.drawCell=function(t,e,i,n,s){void 0===s&&(s="#eeeeee"),this.ctx.fillStyle=s,this.ctx.fillRect(t+3,e+3,i-6,n-6)},n);function n(t){this.pixelWidth=t.pixelWidth,this.pixelHeight=t.pixelHeight,this.resolutionX=t.resolutionX,this.resolutionY=t.resolutionY,this.ctx=t.ctx,this.appleImg=new Image,this.appleImg.src="./apple.png"}var y={w:700,h:700,cellResolutionX:14,cellResolutionY:14},s=5,x=.9,w="#000000",r=5,a=10,l=(h.prototype.update=function(t){this.dir=t.shiftQueuedInput();var e=this.getMovement(),i=e[0],n=e[1],s=this.points[this.points.length-1],o=s.x,r=s.y;this.moveTowardsHead(),this.points[0].x+=i,this.points[0].y+=n,0<this.pendingGrowth&&(this.points.push({x:o,y:r}),this.pendingGrowth--)},h.prototype.isDead=function(t){var e=!1,i=this.points[0];if(!(i.x>=t.xmin&&i.y>=t.ymin&&i.x<=t.xmax&&i.y<=t.ymax))return!0;for(var n=1;n<this.points.length;n++){var s=this.points[n];i.x===s.x&&i.y===s.y&&(e=!0)}return e},h.prototype.draw=function(t){this.points.forEach(this.drawCirle);for(var e=1;e<this.points.length;e++)this.drawEdge(this.points[e-1],this.points[e]);this.drawHead(t)},h.prototype.grow=function(t){this.pendingGrowth+=t},h.prototype.drawHead=function(t){var e=y.w/y.cellResolutionX,i=y.h/y.cellResolutionY;this.ctx.save();var n=this.points[0].x*e+e/2,s=this.points[0].y*i+i/2;switch(this.ctx.translate(n,s),t.mostRecentlyPressed){case"l":this.ctx.rotate(0);break;case"u":this.ctx.rotate(Math.PI/2);break;case"r":this.ctx.scale(-1,1);break;case"d":this.ctx.scale(-1,1),this.ctx.rotate(3*Math.PI/2)}this.ctx.drawImage(this.img,-e/2,-i/2,e,i),this.ctx.restore()},h.prototype.drawEdge=function(t,e){var i=y.cellResolutionX,n=y.cellResolutionY,s=y.w,o=y.h,r=t.x===e.x,a=s/i,l=o/n;if(this.ctx.fillStyle=w,r){var h=(t.y+e.y)/2*l+l/2,u=t.x*a+a/2,p=a*x;this.ctx.fillRect(u-p/2,h-l/2,p,l)}else{var c=(t.x+e.x)/2*a+a/2,d=t.y*l+l/2,f=l*x;this.ctx.fillRect(c-a/2,d-f/2,a,f)}},h.prototype.moveTowardsHead=function(){for(var t=this.points.length-1;0<t;t--){var e=this.points[t];e.x=this.points[t-1].x,e.y=this.points[t-1].y}},h.prototype.getMovement=function(){switch(this.dir){case"u":return[0,-1];case"d":return[0,1];case"l":return[-1,0];case"r":return[1,0];default:return[0,0]}},h);function h(t,e,i){var n=this;this.ctx=i,this.points=[],this.pendingGrowth=0,this.dir="u",this.drawCirle=function(t){var e=y.w/y.cellResolutionX,i=y.h/y.cellResolutionY;n.ctx.fillStyle=w,n.ctx.beginPath(),n.ctx.ellipse(t.x*e+e/2,t.y*i+i/2,e*x/2,i*x/2,0,0,2*Math.PI),n.ctx.closePath(),n.ctx.fill()},this.points.push({x:t,y:e}),this.pendingGrowth=s,this.img=new Image,this.img.src="./snakeHead.png"}var u=(p.prototype.startLoop=function(){var t=this;this.requestedFrameId=requestAnimationFrame(function(){return t.loop()})},p.prototype.endLoop=function(){cancelAnimationFrame(this.requestedFrameId)},p.prototype.loop=function(){var t=this;this.requestedFrameId=requestAnimationFrame(function(){return t.loop()});var e=a;this.loopCount++,this.loopCount%e==0&&(this.snake.update(this.input),this.scoreEl.innerText=this.snake.points.length.toString()),this.isHeadOnApple()&&this.eatApple(),this.ctx.clearRect(0,0,y.w,y.h),this.snake.isDead({xmin:1,xmax:y.cellResolutionX-2,ymin:1,ymax:y.cellResolutionY-2})?(this.endLoop(),this.board.drawDead()):this.board.draw(),this.snake.draw(this.input),this.board.drawApple(this.apple)},p.prototype.isHeadOnApple=function(){var t=this.snake.points[0];return t.x===this.apple.x&&t.y===this.apple.y},p.prototype.eatApple=function(){this.snake.grow(r),this.placeNewApple()},p.prototype.placeNewApple=function(){var t=this.getOpenPoints(),e=t[Math.floor(Math.random()*t.length)];return this.apple=e},p.prototype.getOpenPoints=function(){for(var n=[],t=function(i){for(var t=function(e){s.snake.points.every(function(t){return!(i===t.y&&e===t.x)})&&n.push({x:e,y:i})},e=1;e<y.cellResolutionX-1;e++)t(e)},s=this,e=1;e<y.cellResolutionY-1;e++)t(e);return n},p);function p(t,e,i){this.requestedFrameId=-1,this.loopCount=0,this.canvas=t,this.ctx=t.getContext("2d"),this.scoreEl=i,this.board=new o({ctx:this.ctx,pixelWidth:y.w,pixelHeight:y.h,resolutionX:y.cellResolutionX,resolutionY:y.cellResolutionY}),this.input=e;var n=Math.floor(y.cellResolutionX/2),s=Math.floor(y.cellResolutionY/2);this.snake=new l(n,s,this.ctx),this.placeNewApple()}var c=(d.prototype.addHandlers=function(){this.listenOn.addEventListener("keydown",this.keyDownHandler),this.listenOn.addEventListener("keyup",this.keyUpHandler)},d.prototype.removeHandlers=function(){this.listenOn.addEventListener("keydown",this.keyDownHandler),this.listenOn.addEventListener("keyup",this.keyUpHandler)},d.prototype.shiftQueuedInput=function(){return 0<this.queue.length?this.queue.shift():this.mostRecentlyPressed},d);function d(t){var i=this;this.u=!1,this.d=!1,this.l=!1,this.r=!1,this.mostRecentlyPressed="u",this.queue=["u"],this.keyHandler=function(e){return function(t){switch(t.key){case"ArrowUp":case"w":(i.u=e)&&(i.queue.push("u"),i.mostRecentlyPressed="u");break;case"ArrowLeft":case"a":(i.l=e)&&(i.queue.push("l"),i.mostRecentlyPressed="l");break;case"ArrowDown":case"s":(i.d=e)&&(i.queue.push("d"),i.mostRecentlyPressed="d");break;case"ArrowRight":case"d":(i.r=e)&&(i.queue.push("r"),i.mostRecentlyPressed="r")}}},this.keyDownHandler=this.keyHandler(!0),this.keyUpHandler=this.keyHandler(!1),this.listenOn=t,this.addHandlers()}document.addEventListener("DOMContentLoaded",function(){var t=document.querySelector("canvas"),e=document.querySelector("span");t.width=y.w,t.height=y.h;var i=new c(document.body);new u(t,i,e).startLoop()})}]);